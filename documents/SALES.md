# ğŸ’° Quáº£n lÃ½ BÃ¡n hÃ ng (Sales Management)

## Tá»•ng quan

Module quáº£n lÃ½ bÃ¡n hÃ ng cung cáº¥p giao diá»‡n POS (Point of Sale) hiá»‡n Ä‘áº¡i, giÃºp nhÃ¢n viÃªn thu ngÃ¢n xá»­
lÃ½ Ä‘Æ¡n hÃ ng nhanh chÃ³ng, chÃ­nh xÃ¡c vÃ  nÃ¢ng cao tráº£i nghiá»‡m khÃ¡ch hÃ ng.

## TÃ­nh nÄƒng ChÃ­nh

### 1. POS Interface

#### MÃ n hÃ¬nh POS

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸª MiniRestaurantPro    ğŸ” [Search] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ MENU    â”‚ ÄÆ N HÃ€NG                 â”‚
â”‚         â”‚                           â”‚
â”‚ [All]   â”‚ BÃ n: 5  KhÃ¡ch: 4         â”‚
â”‚ [Khai]  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ [MÃ³n]   â”‚ â”‚ Phá»Ÿ bÃ²      x2  â†‘â†“ â”‚  â”‚
â”‚ [TrÃ¡ng] â”‚ â”‚ 85,000Ä‘    170,000Ä‘â”‚  â”‚
â”‚ [Äá»“]    â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚         â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ Phá»Ÿ bÃ²  â”‚ â”‚ CÃ  phÃª sá»¯a  x1  â†‘â†“ â”‚  â”‚
â”‚ 85,000Ä‘ â”‚ â”‚ 35,000Ä‘     35,000Ä‘â”‚  â”‚
â”‚         â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚ BÃºn cháº£ â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚ 75,000Ä‘ â”‚ Táº¡m tÃ­nh:     205,000Ä‘   â”‚
â”‚         â”‚ Giáº£m giÃ¡:           0Ä‘   â”‚
â”‚ CÆ¡m táº¥m â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚ 70,000Ä‘ â”‚ Tá»”NG:         205,000Ä‘   â”‚
â”‚         â”‚                           â”‚
â”‚ [Grid]  â”‚ [Ghi chÃº] [Giáº£m giÃ¡]    â”‚
â”‚ [List]  â”‚ [Thanh toÃ¡n]             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### TÃ­nh nÄƒng POS

- âœ… TÃ¬m kiáº¿m sáº£n pháº©m nhanh (tÃªn, mÃ£, barcode)
- âœ… QuÃ©t mÃ£ váº¡ch
- âœ… Lá»c theo danh má»¥c
- âœ… Hiá»ƒn thá»‹ hÃ¬nh áº£nh sáº£n pháº©m
- âœ… ThÃªm/bá»›t sá»‘ lÆ°á»£ng nhanh
- âœ… Ghi chÃº cho tá»«ng mÃ³n
- âœ… TÃ­nh tá»•ng tiá»n tá»± Ä‘á»™ng
- âœ… Ãp dá»¥ng giáº£m giÃ¡
- âœ… Nhiá»u phÆ°Æ¡ng thá»©c thanh toÃ¡n
- âœ… In hÃ³a Ä‘Æ¡n nhanh
- âœ… LÆ°u Ä‘Æ¡n hÃ ng táº¡m

### 2. Quáº£n lÃ½ ÄÆ¡n hÃ ng

#### ThÃ´ng tin ÄÆ¡n hÃ ng

```typescript
interface Order {
  id: string;
  orderNumber: string; // MÃ£ Ä‘Æ¡n hÃ ng
  type: OrderType; // Loáº¡i Ä‘Æ¡n
  status: OrderStatus; // Tráº¡ng thÃ¡i

  // Customer
  customerId?: string; // ID khÃ¡ch hÃ ng
  customerInfo?: {
    name?: string;
    phone?: string;
    email?: string;
  };

  // Table/Delivery
  tableNumber?: string; // Sá»‘ bÃ n (dine-in)
  deliveryAddress?: string; // Äá»‹a chá»‰ giao hÃ ng (delivery)

  // Items
  items: OrderItem[]; // Danh sÃ¡ch sáº£n pháº©m

  // Pricing
  subtotal: number; // Táº¡m tÃ­nh
  discount: number; // Giáº£m giÃ¡
  deliveryFee: number; // PhÃ­ giao hÃ ng
  tax: number; // Thuáº¿
  total: number; // Tá»•ng cá»™ng

  // Payment
  paymentMethod?: PaymentMethod; // PT thanh toÃ¡n
  paymentStatus: PaymentStatus; // TT thanh toÃ¡n
  paidAmount: number; // Sá»‘ tiá»n Ä‘Ã£ tráº£
  changeAmount: number; // Tiá»n thá»«a

  // Metadata
  notes?: string; // Ghi chÃº
  staffId: string; // NV táº¡o Ä‘Æ¡n
  completedBy?: string; // NV hoÃ n thÃ nh
  createdAt: string;
  updatedAt: string;
  completedAt?: string;
}

enum OrderType {
  DINE_IN = 'dine_in', // Táº¡i chá»—
  TAKEAWAY = 'takeaway', // Mang Ä‘i
  DELIVERY = 'delivery', // Giao hÃ ng
}

enum OrderStatus {
  DRAFT = 'draft', // NhÃ¡p
  PENDING = 'pending', // Chá» xá»­ lÃ½
  CONFIRMED = 'confirmed', // ÄÃ£ xÃ¡c nháº­n
  PREPARING = 'preparing', // Äang chuáº©n bá»‹
  READY = 'ready', // Sáºµn sÃ ng
  SERVED = 'served', // ÄÃ£ phá»¥c vá»¥
  COMPLETED = 'completed', // HoÃ n thÃ nh
  CANCELLED = 'cancelled', // ÄÃ£ há»§y
}
```

#### Quy trÃ¬nh ÄÆ¡n hÃ ng

**Dine-in (Táº¡i chá»—):**

```
Táº¡o Ä‘Æ¡n â†’ XÃ¡c nháº­n â†’ Chuáº©n bá»‹ â†’ Phá»¥c vá»¥ â†’ Thanh toÃ¡n â†’ HoÃ n thÃ nh
```

**Takeaway (Mang Ä‘i):**

```
Táº¡o Ä‘Æ¡n â†’ Thanh toÃ¡n â†’ Chuáº©n bá»‹ â†’ Sáºµn sÃ ng â†’ Giao khÃ¡ch â†’ HoÃ n thÃ nh
```

**Delivery (Giao hÃ ng):**

```
Táº¡o Ä‘Æ¡n â†’ XÃ¡c nháº­n â†’ Chuáº©n bá»‹ â†’ Giao hÃ ng â†’ Thanh toÃ¡n â†’ HoÃ n thÃ nh
```

### 3. Quáº£n lÃ½ BÃ n (Table Management)

#### ThÃ´ng tin BÃ n

```typescript
interface Table {
  id: string;
  number: string; // Sá»‘ bÃ n
  capacity: number; // Sá»©c chá»©a
  location: string; // Vá»‹ trÃ­ (Táº§ng 1, Táº§ng 2, VIP)
  status: TableStatus; // Tráº¡ng thÃ¡i
  currentOrderId?: string; // ÄÆ¡n hÃ ng hiá»‡n táº¡i
  reservedBy?: string; // NgÆ°á»i Ä‘áº·t bÃ n
  reservedAt?: string; // Thá»i gian Ä‘áº·t
  isActive: boolean;
}

enum TableStatus {
  AVAILABLE = 'available', // Trá»‘ng
  OCCUPIED = 'occupied', // CÃ³ khÃ¡ch
  RESERVED = 'reserved', // ÄÃ£ Ä‘áº·t
  CLEANING = 'cleaning', // Äang dá»n
  MAINTENANCE = 'maintenance', // Báº£o trÃ¬
}
```

#### SÆ¡ Ä‘á»“ BÃ n

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸª‘ Quáº£n lÃ½ bÃ n         Táº§ng: [1 â–¼] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”Œâ”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”         â”‚
â”‚ â”‚ T1  â”‚  â”‚ T2  â”‚  â”‚ T3  â”‚         â”‚
â”‚ â”‚ ğŸŸ¢  â”‚  â”‚ ğŸ”´  â”‚  â”‚ ğŸŸ¡  â”‚         â”‚
â”‚ â”‚ 4   â”‚  â”‚ 4   â”‚  â”‚ 2   â”‚         â”‚
â”‚ â””â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                     â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚ â”‚ T4  â”‚  â”‚ T5  â”‚  â”‚  T6   â”‚       â”‚
â”‚ â”‚ ğŸŸ¢  â”‚  â”‚ ğŸŸ¢  â”‚  â”‚  ğŸ”´   â”‚       â”‚
â”‚ â”‚ 6   â”‚  â”‚ 4   â”‚  â”‚  8VIP â”‚       â”‚
â”‚ â””â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸŸ¢ Trá»‘ng: 3  ğŸ”´ CÃ³ khÃ¡ch: 2  ğŸŸ¡ Äáº·t: 1â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### TÃ­nh nÄƒng

- Xem tráº¡ng thÃ¡i bÃ n real-time
- Äáº·t bÃ n trÆ°á»›c
- GhÃ©p/tÃ¡ch bÃ n
- Chuyá»ƒn bÃ n
- Gá»i mÃ³n cho bÃ n
- TÃ¡ch/gá»™p hÃ³a Ä‘Æ¡n

```typescript
// Reserve table
await TableService.reserveTable(tableId, {
  customerName: 'Nguyá»…n VÄƒn A',
  phone: '0901234567',
  partySize: 4,
  reservedAt: '2025-11-23 18:00',
});

// Move order to another table
await OrderService.moveToTable(orderId, newTableId);

// Merge tables
await TableService.mergeTables([table1Id, table2Id]);

// Split bill
await OrderService.splitBill(orderId, {
  bill1: { items: [item1, item2], total: 200000 },
  bill2: { items: [item3, item4], total: 150000 },
});
```

### 4. Khuyáº¿n mÃ£i vÃ  Giáº£m giÃ¡

#### Loáº¡i Khuyáº¿n mÃ£i

```typescript
interface Promotion {
  id: string;
  code: string; // MÃ£ khuyáº¿n mÃ£i
  name: string; // TÃªn chÆ°Æ¡ng trÃ¬nh
  type: PromotionType; // Loáº¡i
  value: number; // GiÃ¡ trá»‹

  // Conditions
  minOrderValue?: number; // GiÃ¡ trá»‹ Ä‘Æ¡n tá»‘i thiá»ƒu
  maxDiscountValue?: number; // Giáº£m tá»‘i Ä‘a
  applicableProducts?: string[]; // SP Ã¡p dá»¥ng
  applicableCategories?: string[]; // DM Ã¡p dá»¥ng

  // Usage
  usageLimit?: number; // Sá»‘ láº§n sá»­ dá»¥ng tá»‘i Ä‘a
  usageCount: number; // ÄÃ£ sá»­ dá»¥ng
  perUserLimit?: number; // Giá»›i háº¡n/khÃ¡ch

  // Time
  startDate: string;
  endDate: string;

  // Status
  isActive: boolean;
  createdAt: string;
}

enum PromotionType {
  PERCENTAGE = 'percentage', // Giáº£m %
  FIXED_AMOUNT = 'fixed_amount', // Giáº£m sá»‘ tiá»n cá»‘ Ä‘á»‹nh
  BUY_X_GET_Y = 'buy_x_get_y', // Mua X táº·ng Y
  COMBO = 'combo', // Combo
  FREE_SHIPPING = 'free_shipping', // Miá»…n phÃ­ ship
}
```

#### Ãp dá»¥ng Khuyáº¿n mÃ£i

```typescript
// Apply promotion code
const result = await PromotionService.applyPromotion(orderId, 'SALE20');
// Result: { discount: 50000, message: 'Giáº£m 20%' }

// Auto apply promotions
const promotions = await PromotionService.getApplicablePromotions(order);
const bestPromotion = promotions.sort((a, b) => b.discount - a.discount)[0];
```

### 5. KhÃ¡ch hÃ ng ThÃ¢n thiáº¿t (Loyalty Program)

#### ThÃ´ng tin KhÃ¡ch hÃ ng

```typescript
interface Customer {
  id: string;
  code: string; // MÃ£ KH
  name: string;
  phone: string;
  email?: string;
  address?: string;
  birthday?: string;

  // Loyalty
  membershipTier: MembershipTier; // Háº¡ng thÃ nh viÃªn
  points: number; // Äiá»ƒm tÃ­ch lÅ©y
  totalSpent: number; // Tá»•ng chi tiÃªu
  visitCount: number; // Sá»‘ láº§n Ä‘áº¿n
  lastVisit: string; // Láº§n cuá»‘i

  // Preferences
  favoriteProducts?: string[]; // SP yÃªu thÃ­ch
  allergies?: string[]; // Dá»‹ á»©ng
  notes?: string; // Ghi chÃº

  createdAt: string;
  updatedAt: string;
}

enum MembershipTier {
  BRONZE = 'bronze', // Äá»“ng (< 5M)
  SILVER = 'silver', // Báº¡c (5M - 10M)
  GOLD = 'gold', // VÃ ng (10M - 20M)
  PLATINUM = 'platinum', // Báº¡ch kim (> 20M)
  DIAMOND = 'diamond', // Kim cÆ°Æ¡ng (> 50M)
}
```

#### TÃ­ch Ä‘iá»ƒm

```typescript
// Calculate points
const pointsEarned = Math.floor(order.total / 10000); // 1 Ä‘iá»ƒm/10k

// Add points
await CustomerService.addPoints(customerId, pointsEarned, {
  orderId: order.id,
  reason: 'Purchase',
});

// Redeem points
await CustomerService.redeemPoints(customerId, 100, {
  orderId: order.id,
  value: 100000, // 100 Ä‘iá»ƒm = 100k
});
```

#### Benefits by Tier

```typescript
const tierBenefits = {
  bronze: { discount: 0, pointsMultiplier: 1 },
  silver: { discount: 5, pointsMultiplier: 1.2 },
  gold: { discount: 10, pointsMultiplier: 1.5 },
  platinum: { discount: 15, pointsMultiplier: 2 },
  diamond: { discount: 20, pointsMultiplier: 3 },
};
```

### 6. BÃ¡o cÃ¡o BÃ¡n hÃ ng

#### CÃ¡c loáº¡i BÃ¡o cÃ¡o

1. **BÃ¡o cÃ¡o Doanh thu**

   - Doanh thu theo ngÃ y/tuáº§n/thÃ¡ng/nÄƒm
   - So sÃ¡nh vá»›i ká»³ trÆ°á»›c
   - Biá»ƒu Ä‘á»“ xu hÆ°á»›ng

2. **BÃ¡o cÃ¡o Sáº£n pháº©m**

   - Top sáº£n pháº©m bÃ¡n cháº¡y
   - Sáº£n pháº©m Ã­t bÃ¡n
   - PhÃ¢n tÃ­ch theo danh má»¥c

3. **BÃ¡o cÃ¡o KhÃ¡ch hÃ ng**

   - KhÃ¡ch hÃ ng má»›i/quay láº¡i
   - KhÃ¡ch hÃ ng VIP
   - PhÃ¢n tÃ­ch hÃ nh vi mua

4. **BÃ¡o cÃ¡o Hiá»‡u suáº¥t**
   - Doanh thu theo nhÃ¢n viÃªn
   - Sá»‘ Ä‘Æ¡n xá»­ lÃ½
   - Thá»i gian phá»¥c vá»¥ trung bÃ¬nh

## UI/UX Design

### MÃ n hÃ¬nh Táº¡o Ä‘Æ¡n hÃ ng

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â† Táº¡o Ä‘Æ¡n má»›i                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Loáº¡i Ä‘Æ¡n: [Táº¡i chá»— â–¼] BÃ n: [5 â–¼]  â”‚
â”‚ KhÃ¡ch hÃ ng: [0901234567]  ğŸ”       â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Nguyá»…n VÄƒn A - Báº¡c â­          â”‚ â”‚
â”‚ â”‚ Äiá»ƒm: 150 | Chi tiÃªu: 5.2M     â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ MÃ³n Ä‘Ã£ chá»n:                        â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Phá»Ÿ bÃ²          x2    170,000Ä‘ â”‚ â”‚
â”‚ â”‚ Ghi chÃº: KhÃ´ng hÃ nh            â”‚ â”‚
â”‚ â”‚ [âœï¸] [ğŸ—‘ï¸]                      â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [+ ThÃªm mÃ³n]  [ğŸŸï¸ Khuyáº¿n mÃ£i]     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Táº¡m tÃ­nh:              170,000Ä‘    â”‚
â”‚ Giáº£m giÃ¡ (Báº¡c 5%):      -8,500Ä‘    â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚
â”‚ Tá»”NG:                  161,500Ä‘    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [LÆ°u nhÃ¡p]  [XÃ¡c nháº­n Ä‘Æ¡n]        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## API Endpoints

### Sales Service

```typescript
class SalesService {
  // Orders
  static async createOrder(data: CreateOrderData): Promise<Order>;
  static async getOrders(filters?: OrderFilters): Promise<Order[]>;
  static async getOrderById(id: string): Promise<Order>;
  static async updateOrderStatus(id: string, status: OrderStatus): Promise<Order>;
  static async cancelOrder(id: string, reason: string): Promise<void>;

  // Tables
  static async getTables(): Promise<Table[]>;
  static async reserveTable(tableId: string, data: ReservationData): Promise<Table>;
  static async occupyTable(tableId: string, orderId: string): Promise<Table>;
  static async releaseTable(tableId: string): Promise<Table>;

  // Promotions
  static async getPromotions(active?: boolean): Promise<Promotion[]>;
  static async applyPromotion(orderId: string, code: string): Promise<DiscountResult>;

  // Customers
  static async getCustomers(): Promise<Customer[]>;
  static async getCustomerByPhone(phone: string): Promise<Customer>;
  static async createCustomer(data: CreateCustomerData): Promise<Customer>;
  static async addPoints(customerId: string, points: number): Promise<Customer>;
  static async redeemPoints(customerId: string, points: number): Promise<Customer>;
}
```

## Use Cases & Process Flows

### Use Case 1: Táº¡o ÄÆ¡n hÃ ng Táº¡i chá»— (Dine-in)

**Actors:** Thu ngÃ¢n, KhÃ¡ch hÃ ng, Báº¿p

**Preconditions:**

- Thu ngÃ¢n Ä‘Ã£ Ä‘Äƒng nháº­p
- CÃ³ bÃ n trá»‘ng hoáº·c khÃ¡ch Ä‘Ã£ chá»n bÃ n
- Menu cÃ³ sáº£n pháº©m

**Main Flow:**

```
1. Thu ngÃ¢n má»Ÿ mÃ n hÃ¬nh POS
2. Chá»n loáº¡i Ä‘Æ¡n "Dine-in"
3. Chá»n sá»‘ bÃ n
4. [Optional] QuÃ©t tháº» khÃ¡ch hÃ ng thÃ nh viÃªn hoáº·c nháº­p SÄT
   4.1. Há»‡ thá»‘ng hiá»ƒn thá»‹ thÃ´ng tin KH (tÃªn, háº¡ng, Ä‘iá»ƒm)
   4.2. Ãp dá»¥ng tá»± Ä‘á»™ng giáº£m giÃ¡ theo háº¡ng
5. ThÃªm mÃ³n Äƒn vÃ o Ä‘Æ¡n:
   5.1. TÃ¬m kiáº¿m hoáº·c chá»n tá»« menu
   5.2. Chá»n sá»‘ lÆ°á»£ng
   5.3. [Optional] ThÃªm ghi chÃº (khÃ´ng hÃ nh, Ã­t cay...)
   5.4. Kiá»ƒm tra tá»“n kho
   5.5. ThÃªm vÃ o Ä‘Æ¡n hÃ ng
6. Láº·p láº¡i bÆ°á»›c 5 cho cÃ¡c mÃ³n khÃ¡c
7. [Optional] Ãp dá»¥ng mÃ£ khuyáº¿n mÃ£i:
   7.1. Nháº­p mÃ£ voucher
   7.2. Há»‡ thá»‘ng validate vÃ  tÃ­nh giáº£m giÃ¡
8. Xem tá»•ng cá»™ng (táº¡m tÃ­nh + thuáº¿ - giáº£m giÃ¡)
9. XÃ¡c nháº­n Ä‘Æ¡n hÃ ng
10. Há»‡ thá»‘ng:
    10.1. Táº¡o order (status: PENDING)
    10.2. Trá»« tá»“n kho táº¡m thá»i (reserved)
    10.3. Gá»­i order Ä‘áº¿n báº¿p
    10.4. Cáº­p nháº­t tráº¡ng thÃ¡i bÃ n: OCCUPIED
11. In phiáº¿u order cho báº¿p
12. Thu ngÃ¢n thÃ´ng bÃ¡o khÃ¡ch "ÄÆ¡n Ä‘Ã£ Ä‘Æ°á»£c gá»­i Ä‘áº¿n báº¿p"
```

**Alternative Flows:**

**A1: Sáº£n pháº©m háº¿t hÃ ng (táº¡i bÆ°á»›c 5.4)**

```
A1.1. Há»‡ thá»‘ng hiá»ƒn thá»‹ "Sáº£n pháº©m táº¡m háº¿t"
A1.2. Thu ngÃ¢n thÃ´ng bÃ¡o khÃ¡ch
A1.3. Quay láº¡i bÆ°á»›c 5 Ä‘á»ƒ chá»n mÃ³n khÃ¡c
```

**A2: MÃ£ khuyáº¿n mÃ£i khÃ´ng há»£p lá»‡ (táº¡i bÆ°á»›c 7.2)**

```
A2.1. Há»‡ thá»‘ng hiá»ƒn thá»‹ lá»—i "MÃ£ khÃ´ng há»£p lá»‡ hoáº·c Ä‘Ã£ háº¿t háº¡n"
A2.2. Thu ngÃ¢n cÃ³ thá»ƒ:
      - Nháº­p mÃ£ khÃ¡c
      - Bá» qua vÃ  tiáº¿p tá»¥c
```

**A3: KhÃ¡ch Ä‘á»•i Ã½/bá»• sung mÃ³n (sau bÆ°á»›c 11)**

```
A3.1. Thu ngÃ¢n má»Ÿ láº¡i Ä‘Æ¡n hÃ ng
A3.2. ThÃªm/bá»›t mÃ³n
A3.3. XÃ¡c nháº­n thay Ä‘á»•i
A3.4. Gá»­i order bá»• sung Ä‘áº¿n báº¿p
```

**Postconditions:**

- ÄÆ¡n hÃ ng Ä‘Æ°á»£c táº¡o vá»›i status PENDING
- BÃ n Ä‘Æ°á»£c Ä‘Ã¡nh dáº¥u OCCUPIED
- Order Ä‘Æ°á»£c gá»­i Ä‘áº¿n mÃ n hÃ¬nh báº¿p
- Tá»“n kho Ä‘Æ°á»£c reserve

**Business Rules:**

- Má»—i bÃ n chá»‰ cÃ³ 1 Ä‘Æ¡n hÃ ng active
- Pháº£i cÃ³ Ã­t nháº¥t 1 mÃ³n trong Ä‘Æ¡n
- KhÃ´ng thá»ƒ Ä‘áº·t mÃ³n háº¿t hÃ ng
- Khuyáº¿n mÃ£i khÃ´ng cá»™ng dá»“n (chá»n 1 tá»‘t nháº¥t)

---

### Use Case 2: Thanh ToÃ¡n ÄÆ¡n hÃ ng

**Actors:** Thu ngÃ¢n, KhÃ¡ch hÃ ng

**Preconditions:**

- ÄÆ¡n hÃ ng Ä‘Ã£ hoÃ n thÃ nh (status: READY hoáº·c SERVED)
- KhÃ¡ch yÃªu cáº§u thanh toÃ¡n

**Main Flow:**

```
1. Thu ngÃ¢n má»Ÿ Ä‘Æ¡n hÃ ng cáº§n thanh toÃ¡n
2. Kiá»ƒm tra láº¡i danh sÃ¡ch mÃ³n vÃ  tá»•ng tiá»n
3. [Optional] KhÃ¡ch yÃªu cáº§u tÃ¡ch bill:
   3.1. Thu ngÃ¢n chá»n "TÃ¡ch bill"
   3.2. PhÃ¢n chia mÃ³n cho tá»«ng bill
   3.3. Há»‡ thá»‘ng táº¡o cÃ¡c sub-bills
   3.4. Tiáº¿p tá»¥c vá»›i tá»«ng bill riÃªng
4. Chá»n phÆ°Æ¡ng thá»©c thanh toÃ¡n:

   CASE Tiá»n máº·t:
   4.1. Nháº­p sá»‘ tiá»n khÃ¡ch Ä‘Æ°a
   4.2. Há»‡ thá»‘ng tÃ­nh tiá»n thá»«a
   4.3. Thu ngÃ¢n Ä‘Æ°a tiá»n thá»«a cho khÃ¡ch

   CASE Tháº»:
   4.4. Thu ngÃ¢n quáº¹t tháº» qua mÃ¡y POS
   4.5. KhÃ¡ch nháº­p PIN
   4.6. Chá» xÃ¡c nháº­n tá»« ngÃ¢n hÃ ng
   4.7. In hÃ³a Ä‘Æ¡n tháº»

   CASE Chuyá»ƒn khoáº£n:
   4.8. Hiá»ƒn thá»‹ QR code hoáº·c STK
   4.9. KhÃ¡ch chuyá»ƒn khoáº£n
   4.10. Thu ngÃ¢n kiá»ƒm tra banking app
   4.11. XÃ¡c nháº­n Ä‘Ã£ nháº­n tiá»n

   CASE QR Code (VNPay, MoMo...):
   4.12. Táº¡o QR code thanh toÃ¡n
   4.13. KhÃ¡ch quÃ©t mÃ£
   4.14. Há»‡ thá»‘ng nháº­n webhook xÃ¡c nháº­n
   4.15. Auto confirm payment

5. XÃ¡c nháº­n thanh toÃ¡n
6. Há»‡ thá»‘ng:
   6.1. Cáº­p nháº­t order status: COMPLETED
   6.2. Cáº­p nháº­t payment status: PAID
   6.3. Táº¡o invoice (hÃ³a Ä‘Æ¡n)
   6.4. XÃ¡c nháº­n xuáº¥t kho (commit reserved stock)
   6.5. Cáº­p nháº­t tráº¡ng thÃ¡i bÃ n: CLEANING
   6.6. [If customer member] Cá»™ng Ä‘iá»ƒm tÃ­ch lÅ©y
   6.7. Ghi nháº­n vÃ o bÃ¡o cÃ¡o doanh thu
7. In hÃ³a Ä‘Æ¡n cho khÃ¡ch
8. [Optional] Gá»­i hÃ³a Ä‘Æ¡n qua email/SMS
9. Thu ngÃ¢n cáº£m Æ¡n vÃ  tiá»…n khÃ¡ch
```

**Alternative Flows:**

**A1: Thanh toÃ¡n tháº» tháº¥t báº¡i (táº¡i bÆ°á»›c 4.6)**

```
A1.1. Há»‡ thá»‘ng hiá»ƒn thá»‹ "Giao dá»‹ch tháº¥t báº¡i"
A1.2. Thu ngÃ¢n thÃ´ng bÃ¡o khÃ¡ch
A1.3. Quay láº¡i bÆ°á»›c 4 chá»n PT thanh toÃ¡n khÃ¡c
```

**A2: KhÃ¡ch yÃªu cáº§u giáº£m giÃ¡ (táº¡i bÆ°á»›c 2)**

```
A2.1. Thu ngÃ¢n yÃªu cáº§u Manager phÃª duyá»‡t
A2.2. Manager xem Ä‘Æ¡n vÃ  quyáº¿t Ä‘á»‹nh
A2.3. [If approved] Nháº­p % hoáº·c sá»‘ tiá»n giáº£m + lÃ½ do
A2.4. Há»‡ thá»‘ng cáº­p nháº­t tá»•ng tiá»n
A2.5. Tiáº¿p tá»¥c bÆ°á»›c 4
```

**A3: Thanh toÃ¡n má»™t pháº§n (táº¡i bÆ°á»›c 4)**

```
A3.1. Thu ngÃ¢n chá»n "Thanh toÃ¡n má»™t pháº§n"
A3.2. Nháº­p sá»‘ tiá»n thanh toÃ¡n
A3.3. Há»‡ thá»‘ng cáº­p nháº­t:
      - Payment status: PARTIAL
      - Remaining amount
A3.4. CÃ³ thá»ƒ thanh toÃ¡n pháº§n cÃ²n láº¡i sau
```

**Postconditions:**

- ÄÆ¡n hÃ ng hoÃ n thÃ nh
- Thanh toÃ¡n thÃ nh cÃ´ng
- HÃ³a Ä‘Æ¡n Ä‘Æ°á»£c táº¡o
- BÃ n Ä‘Æ°á»£c giáº£i phÃ³ng
- Doanh thu Ä‘Æ°á»£c ghi nháº­n

---

### Use Case 3: Quáº£n lÃ½ BÃ n - Chuyá»ƒn BÃ n

**Actors:** NhÃ¢n viÃªn phá»¥c vá»¥, Thu ngÃ¢n

**Preconditions:**

- CÃ³ Ä‘Æ¡n hÃ ng Ä‘ang active trÃªn bÃ n nguá»“n
- BÃ n Ä‘Ã­ch Ä‘ang trá»‘ng (status: AVAILABLE)

**Main Flow:**

```
1. NhÃ¢n viÃªn nháº­n yÃªu cáº§u chuyá»ƒn bÃ n tá»« khÃ¡ch
2. Kiá»ƒm tra bÃ n Ä‘Ã­ch cÃ³ trá»‘ng khÃ´ng
3. Má»Ÿ chá»©c nÄƒng "Quáº£n lÃ½ bÃ n"
4. Chá»n bÃ n nguá»“n (bÃ n hiá»‡n táº¡i)
5. Há»‡ thá»‘ng hiá»ƒn thá»‹ thÃ´ng tin Ä‘Æ¡n hÃ ng:
   - Sá»‘ mÃ³n
   - Tá»•ng tiá»n
   - Thá»i gian ngá»“i
6. Chá»n "Chuyá»ƒn bÃ n"
7. Chá»n bÃ n Ä‘Ã­ch tá»« sÆ¡ Ä‘á»“ bÃ n
8. [Optional] Nháº­p lÃ½ do chuyá»ƒn bÃ n
9. XÃ¡c nháº­n chuyá»ƒn bÃ n
10. Há»‡ thá»‘ng:
    10.1. Cáº­p nháº­t order.tableNumber = bÃ n Ä‘Ã­ch
    10.2. Cáº­p nháº­t bÃ n nguá»“n: AVAILABLE
    10.3. Cáº­p nháº­t bÃ n Ä‘Ã­ch: OCCUPIED
    10.4. Ghi log lá»‹ch sá»­
11. ThÃ´ng bÃ¡o thÃ nh cÃ´ng
12. NhÃ¢n viÃªn hÆ°á»›ng dáº«n khÃ¡ch Ä‘áº¿n bÃ n má»›i
```

**Alternative Flows:**

**A1: BÃ n Ä‘Ã­ch Ä‘ang cÃ³ khÃ¡ch (táº¡i bÆ°á»›c 2)**

```
A1.1. Há»‡ thá»‘ng hiá»ƒn thá»‹ "BÃ n Ä‘ang cÃ³ khÃ¡ch"
A1.2. NhÃ¢n viÃªn cÃ³ thá»ƒ:
      - Chá»n bÃ n khÃ¡c
      - Há»§y thao tÃ¡c
```

**A2: Gá»™p 2 Ä‘Æ¡n hÃ ng (khÃ¡ch muá»‘n ngá»“i chung)**

```
A2.1. Chá»n "Gá»™p bÃ n" thay vÃ¬ "Chuyá»ƒn bÃ n"
A2.2. Chá»n 2 bÃ n cáº§n gá»™p
A2.3. Chá»n bÃ n Ä‘Ã­ch (cÃ³ thá»ƒ lÃ  1 trong 2 hoáº·c bÃ n má»›i)
A2.4. Há»‡ thá»‘ng:
      - Merge 2 orders thÃ nh 1
      - Cáº­p nháº­t table status
A2.5. In láº¡i order tá»•ng há»£p
```

**Postconditions:**

- Order Ä‘Æ°á»£c chuyá»ƒn sang bÃ n má»›i
- Tráº¡ng thÃ¡i cÃ¡c bÃ n Ä‘Æ°á»£c cáº­p nháº­t
- Lá»‹ch sá»­ Ä‘Æ°á»£c ghi nháº­n

---

### Use Case 4: Ãp dá»¥ng Khuyáº¿n mÃ£i

**Actors:** Thu ngÃ¢n, Há»‡ thá»‘ng

**Preconditions:**

- Äang cÃ³ Ä‘Æ¡n hÃ ng active
- CÃ³ chÆ°Æ¡ng trÃ¬nh khuyáº¿n mÃ£i Ä‘ang cháº¡y

**Main Flow:**

**Scenario A: Auto-apply (Khuyáº¿n mÃ£i tá»± Ä‘á»™ng)**

```
1. Thu ngÃ¢n táº¡o Ä‘Æ¡n hÃ ng nhÆ° bÃ¬nh thÆ°á»ng
2. Sau má»—i láº§n thÃªm mÃ³n, há»‡ thá»‘ng:
   2.1. Kiá»ƒm tra cÃ¡c KM Ä‘ang active
   2.2. Kiá»ƒm tra Ä‘iá»u kiá»‡n Ã¡p dá»¥ng:
       - GiÃ¡ trá»‹ Ä‘Æ¡n tá»‘i thiá»ƒu
       - Sáº£n pháº©m/danh má»¥c Ã¡p dá»¥ng
       - Thá»i gian Ã¡p dá»¥ng
       - Sá»‘ láº§n sá»­ dá»¥ng
   2.3. TÃ­nh toÃ¡n giáº£m giÃ¡ cho cÃ¡c KM phÃ¹ há»£p
   2.4. Chá»n KM cÃ³ lá»£i nháº¥t cho khÃ¡ch
   2.5. Tá»± Ä‘á»™ng Ã¡p dá»¥ng
3. Hiá»ƒn thá»‹ KM Ä‘ang Ã¡p dá»¥ng trÃªn mÃ n hÃ¬nh
4. Thu ngÃ¢n thÃ´ng bÃ¡o khÃ¡ch vá» Æ°u Ä‘Ã£i
```

**Scenario B: Manual-apply (Nháº­p mÃ£ voucher)**

```
1. KhÃ¡ch cung cáº¥p mÃ£ voucher
2. Thu ngÃ¢n chá»n "Ãp dá»¥ng mÃ£"
3. Nháº­p mÃ£ voucher
4. Há»‡ thá»‘ng validate:
   4.1. Kiá»ƒm tra mÃ£ cÃ³ tá»“n táº¡i
   4.2. Kiá»ƒm tra cÃ²n hiá»‡u lá»±c (start/end date)
   4.3. Kiá»ƒm tra sá»‘ láº§n sá»­ dá»¥ng (usage limit)
   4.4. Kiá»ƒm tra Ä‘iá»u kiá»‡n Ä‘Æ¡n hÃ ng
   4.5. Kiá»ƒm tra user Ä‘Ã£ dÃ¹ng chÆ°a (per-user limit)
5. [If valid] TÃ­nh giáº£m giÃ¡:

   CASE Percentage:
   5.1. Discount = Subtotal Ã— Percent
   5.2. [If has maxDiscount] Discount = min(Discount, maxDiscount)

   CASE Fixed Amount:
   5.3. Discount = Fixed Value

   CASE Buy X Get Y:
   5.4. Kiá»ƒm tra sá»‘ lÆ°á»£ng X trong Ä‘Æ¡n
   5.5. Táº·ng Y (giáº£m 100% cho Y items)

   CASE Combo:
   5.6. Kiá»ƒm tra cÃ³ Ä‘á»§ mÃ³n trong combo
   5.7. Ãp dá»¥ng giÃ¡ combo

6. Ãp dá»¥ng giáº£m giÃ¡ vÃ o Ä‘Æ¡n
7. Cáº­p nháº­t tá»•ng tiá»n
8. Hiá»ƒn thá»‹ thÃ´ng tin KM Ä‘Ã£ Ã¡p dá»¥ng
9. Ghi nháº­n usage count
```

**Alternative Flows:**

**A1: MÃ£ khÃ´ng há»£p lá»‡ (táº¡i bÆ°á»›c 4)**

```
A1.1. Há»‡ thá»‘ng hiá»ƒn thá»‹ lá»—i cá»¥ thá»ƒ:
      - "MÃ£ khÃ´ng tá»“n táº¡i"
      - "MÃ£ Ä‘Ã£ háº¿t háº¡n"
      - "ÄÆ¡n chÆ°a Ä‘á»§ Ä‘iá»u kiá»‡n (min: XXXÄ‘)"
      - "MÃ£ Ä‘Ã£ háº¿t lÆ°á»£t sá»­ dá»¥ng"
      - "Báº¡n Ä‘Ã£ sá»­ dá»¥ng mÃ£ nÃ y rá»“i"
A1.2. Thu ngÃ¢n thÃ´ng bÃ¡o khÃ¡ch
A1.3. CÃ³ thá»ƒ thá»­ mÃ£ khÃ¡c hoáº·c bá» qua
```

**A2: CÃ³ nhiá»u KM Ã¡p dá»¥ng Ä‘Æ°á»£c (táº¡i bÆ°á»›c 2.4)**

```
A2.1. Há»‡ thá»‘ng tÃ­nh giáº£m giÃ¡ cho táº¥t cáº£ KM
A2.2. Sáº¯p xáº¿p theo má»©c giáº£m giÃ¡ giáº£m dáº§n
A2.3. Chá»n KM cÃ³ giáº£m giÃ¡ cao nháº¥t
A2.4. [Optional] Hiá»ƒn thá»‹ cÃ¡c KM khÃ¡c Ä‘á»ƒ khÃ¡ch chá»n
```

**Postconditions:**

- Khuyáº¿n mÃ£i Ä‘Æ°á»£c Ã¡p dá»¥ng vÃ o Ä‘Æ¡n
- Giáº£m giÃ¡ Ä‘Æ°á»£c tÃ­nh vÃ o tá»•ng tiá»n
- Usage count Ä‘Æ°á»£c cáº­p nháº­t

---

### Use Case 5: TÃ­ch Ä‘iá»ƒm KhÃ¡ch hÃ ng ThÃ nh viÃªn

**Actors:** Thu ngÃ¢n, KhÃ¡ch hÃ ng, Há»‡ thá»‘ng

**Preconditions:**

- KhÃ¡ch hÃ ng cÃ³ tÃ i khoáº£n thÃ nh viÃªn
- ÄÆ¡n hÃ ng Ä‘Æ°á»£c thanh toÃ¡n thÃ nh cÃ´ng

**Main Flow:**

```
1. Táº¡i bÆ°á»›c thanh toÃ¡n, há»‡ thá»‘ng kiá»ƒm tra:
   1.1. ÄÆ¡n cÃ³ liÃªn káº¿t vá»›i customer ID?
   1.2. Customer cÃ³ active membership?
2. TÃ­nh Ä‘iá»ƒm tÃ­ch lÅ©y:
   2.1. Base points = floor(Total / PointsRate)
        VÃ­ dá»¥: 10,000Ä‘ = 1 Ä‘iá»ƒm
   2.2. Tier multiplier:
        - Bronze: 1x
        - Silver: 1.2x
        - Gold: 1.5x
        - Platinum: 2x
        - Diamond: 3x
   2.3. Final points = Base points Ã— Multiplier

   VÃ­ dá»¥:
   - Order: 500,000Ä‘
   - Tier: Gold (1.5x)
   - Points = (500,000 / 10,000) Ã— 1.5 = 75 Ä‘iá»ƒm

3. Cá»™ng Ä‘iá»ƒm vÃ o tÃ i khoáº£n:
   3.1. customer.points += Final points
   3.2. customer.totalSpent += Order.total
   3.3. customer.visitCount += 1
   3.4. customer.lastVisit = now

4. Kiá»ƒm tra nÃ¢ng háº¡ng:
   4.1. TÃ­nh totalSpent tá»« trÆ°á»›c Ä‘áº¿n nay
   4.2. So sÃ¡nh vá»›i ngÆ°á»¡ng nÃ¢ng háº¡ng:
       - Bronze: < 5M
       - Silver: 5M - 10M
       - Gold: 10M - 20M
       - Platinum: 20M - 50M
       - Diamond: > 50M
   4.3. [If qualified] NÃ¢ng háº¡ng tá»± Ä‘á»™ng
   4.4. [If upgraded] Gá»­i thÃ´ng bÃ¡o vÃ  Æ°u Ä‘Ã£i

5. Ghi nháº­n transaction:
   5.1. Táº¡o PointsTransaction:
       - type: EARN
       - points: +75
       - orderId
       - reason: "Purchase"
       - timestamp

6. Hiá»ƒn thá»‹ trÃªn mÃ n hÃ¬nh:
   "Cá»™ng 75 Ä‘iá»ƒm | Tá»•ng: 825 Ä‘iá»ƒm"
   [If upgraded] "ChÃºc má»«ng! Báº¡n Ä‘Ã£ lÃªn háº¡ng Gold"

7. [Optional] In thÃ´ng tin Ä‘iá»ƒm trÃªn hÃ³a Ä‘Æ¡n
```

**Alternative Flows:**

**A1: Äá»•i Ä‘iá»ƒm láº¥y quÃ  (trÆ°á»›c thanh toÃ¡n)**

```
A1.1. KhÃ¡ch yÃªu cáº§u Ä‘á»•i Ä‘iá»ƒm
A1.2. Thu ngÃ¢n chá»n "Äá»•i Ä‘iá»ƒm"
A1.3. Hiá»ƒn thá»‹ danh sÃ¡ch rewards:
      - 100 Ä‘iá»ƒm = Giáº£m 100,000Ä‘
      - 50 Ä‘iá»ƒm = Táº·ng mÃ³n trÃ¡ng miá»‡ng
      - 200 Ä‘iá»ƒm = Voucher 200,000Ä‘
A1.4. KhÃ¡ch chá»n reward
A1.5. Kiá»ƒm tra Ä‘iá»ƒm Ä‘á»§ khÃ´ng
A1.6. [If enough] Trá»« Ä‘iá»ƒm:
      - customer.points -= Required points
      - Ãp dá»¥ng reward vÃ o Ä‘Æ¡n
A1.7. Ghi nháº­n transaction:
      - type: REDEEM
      - points: -100
      - reward: "Discount 100k"
A1.8. Tiáº¿p tá»¥c thanh toÃ¡n vá»›i giÃ¡ Ä‘Ã£ giáº£m
```

**A2: KhÃ¡ch chÆ°a cÃ³ tÃ i khoáº£n (táº¡i bÆ°á»›c 1)**

```
A2.1. Thu ngÃ¢n há»i: "Anh/chá»‹ cÃ³ muá»‘n Ä‘Äƒng kÃ½ tháº» thÃ nh viÃªn?"
A2.2. [If yes] Thu tháº­p thÃ´ng tin:
       - Há» tÃªn
       - Sá»‘ Ä‘iá»‡n thoáº¡i
       - Email (optional)
       - NgÃ y sinh (optional)
A2.3. Táº¡o tÃ i khoáº£n thÃ nh viÃªn:
       - membershipTier: BRONZE
       - points: 0
       - totalSpent: 0
A2.4. [Optional] Táº·ng Ä‘iá»ƒm welcome bonus (vd: 50 Ä‘iá»ƒm)
A2.5. LiÃªn káº¿t vá»›i Ä‘Æ¡n hÃ ng hiá»‡n táº¡i
A2.6. Tiáº¿p tá»¥c flow chÃ­nh tá»« bÆ°á»›c 2
```

**Postconditions:**

- Äiá»ƒm Ä‘Æ°á»£c cá»™ng vÃ o tÃ i khoáº£n
- ThÃ´ng tin khÃ¡ch hÃ ng Ä‘Æ°á»£c cáº­p nháº­t
- Transaction Ä‘Æ°á»£c ghi nháº­n
- [If applicable] Háº¡ng thÃ nh viÃªn Ä‘Æ°á»£c nÃ¢ng

---

### Use Case 6: Xá»­ lÃ½ ÄÆ¡n Takeaway (Mang Ä‘i)

**Actors:** Thu ngÃ¢n, KhÃ¡ch hÃ ng, Báº¿p

**Preconditions:**

- Thu ngÃ¢n Ä‘Ã£ Ä‘Äƒng nháº­p
- Menu cÃ³ sáº£n pháº©m

**Main Flow:**

```
1. KhÃ¡ch Ä‘áº¿n quáº§y Ä‘áº·t mÃ³n mang Ä‘i
2. Thu ngÃ¢n má»Ÿ POS, chá»n "Takeaway"
3. [Optional] Láº¥y thÃ´ng tin khÃ¡ch:
   3.1. TÃªn
   3.2. Sá»‘ Ä‘iá»‡n thoáº¡i
   3.3. [If member] QuÃ©t tháº»/nháº­p SÄT
4. Nháº­n order tá»« khÃ¡ch:
   4.1. ThÃªm mÃ³n vÃ o Ä‘Æ¡n
   4.2. XÃ¡c nháº­n sá»‘ lÆ°á»£ng
   4.3. Ghi chÃº Ä‘áº·c biá»‡t
5. [Optional] Ãp dá»¥ng khuyáº¿n mÃ£i
6. TÃ­nh tá»•ng tiá»n
7. XÃ¡c nháº­n vá»›i khÃ¡ch:
   "Tá»•ng cá»™ng XXXÄ‘, anh/chá»‹ thanh toÃ¡n luÃ´n hay khi láº¥y hÃ ng?"

   CASE A: Thanh toÃ¡n ngay (Pre-paid)
   8A.1. Chá»n phÆ°Æ¡ng thá»©c thanh toÃ¡n
   8A.2. Xá»­ lÃ½ thanh toÃ¡n (nhÆ° UC2)
   8A.3. In hÃ³a Ä‘Æ¡n
   8A.4. Order status: PAID

   CASE B: Thanh toÃ¡n khi láº¥y (Pay on pickup)
   8B.1. Order status: PENDING
   8B.2. In phiáº¿u order

9. Æ¯á»›c tÃ­nh thá»i gian chuáº©n bá»‹:
   9.1. Há»‡ thá»‘ng tÃ­nh dá»±a trÃªn:
       - Sá»‘ lÆ°á»£ng mÃ³n
       - Äá»™ phá»©c táº¡p mÃ³n
       - Sá»‘ order Ä‘ang xá»­ lÃ½
   9.2. Estimated time = SUM(item.prepTime) + Queue time
   9.3. Add 20% buffer

   VÃ­ dá»¥:
   - 2 Phá»Ÿ (15 phÃºt) + 1 CÆ¡m (10 phÃºt) = 25 phÃºt
   - Queue: 5 phÃºt
   - Buffer: 6 phÃºt
   - Total: ~35 phÃºt

10. ThÃ´ng bÃ¡o khÃ¡ch:
    "ÄÆ¡n hÃ ng sáº½ sáºµn sÃ ng sau khoáº£ng 35 phÃºt"
    "Vui lÃ²ng quay láº¡i lÃºc [time] Ä‘á»ƒ láº¥y"

11. Gá»­i order Ä‘áº¿n báº¿p vá»›i priority: TAKEAWAY

12. [Optional] Gá»­i SMS thÃ´ng bÃ¡o:
    "ÄÆ¡n hÃ ng #XXX Ä‘Ã£ Ä‘Æ°á»£c xÃ¡c nháº­n. Dá»± kiáº¿n sáºµn sÃ ng lÃºc HH:MM"

13. Thu ngÃ¢n Ä‘Æ°a khÃ¡ch phiáº¿u cÃ³ mÃ£ order

--- Khi khÃ¡ch quay láº¡i láº¥y hÃ ng ---

14. KhÃ¡ch Ä‘áº¿n quáº§y vá»›i phiáº¿u/mÃ£ order
15. Thu ngÃ¢n tra cá»©u order báº±ng:
    - MÃ£ order
    - Sá»‘ Ä‘iá»‡n thoáº¡i
16. Kiá»ƒm tra order status:

    IF status = READY:
    17.1. BÃ n giao hÃ ng cho khÃ¡ch
    17.2. [If unpaid] Xá»­ lÃ½ thanh toÃ¡n
    17.3. Cáº­p nháº­t status: COMPLETED
    17.4. [If member] Cá»™ng Ä‘iá»ƒm

    IF status = PREPARING:
    17.5. ThÃ´ng bÃ¡o: "ÄÆ¡n hÃ ng Ä‘ang chuáº©n bá»‹, vui lÃ²ng chá» X phÃºt"
    17.6. [Optional] Má»i khÃ¡ch ngá»“i chá»

18. Cáº£m Æ¡n vÃ  tiá»…n khÃ¡ch
```

**Alternative Flows:**

**A1: KhÃ¡ch muá»‘n thay Ä‘á»•i order (trÆ°á»›c khi báº¿p báº¯t Ä‘áº§u)**

```
A1.1. Thu ngÃ¢n tra order
A1.2. Kiá»ƒm tra status:
      IF status = PENDING (chÆ°a báº¯t Ä‘áº§u náº¥u):
      A1.3. Cho phÃ©p sá»­a
      A1.4. ThÃªm/bá»›t/Ä‘á»•i mÃ³n
      A1.5. Cáº­p nháº­t giÃ¡
      A1.6. [If paid] Xá»­ lÃ½ hoÃ n/thu thÃªm tiá»n
      A1.7. Gá»­i láº¡i order Ä‘áº¿n báº¿p

      IF status = PREPARING (Ä‘ang náº¥u):
      A1.8. ThÃ´ng bÃ¡o "ÄÆ¡n Ä‘ang chuáº©n bá»‹, khÃ´ng thá»ƒ sá»­a"
```

**A2: KhÃ¡ch há»§y order (trÆ°á»›c khi láº¥y hÃ ng)**

```
A2.1. KhÃ¡ch gá»i Ä‘iá»‡n hoáº·c Ä‘áº¿n quáº§y há»§y
A2.2. Thu ngÃ¢n tra order
A2.3. Kiá»ƒm tra status vÃ  payment:

      IF unpaid:
      A2.4. Há»§y order ngay
      A2.5. Cáº­p nháº­t status: CANCELLED
      A2.6. HoÃ n láº¡i tá»“n kho

      IF paid + chÆ°a báº¯t Ä‘áº§u náº¥u:
      A2.7. Há»§y order
      A2.8. HoÃ n tiá»n 100%

      IF paid + Ä‘ang náº¥u/Ä‘Ã£ náº¥u xong:
      A2.9. ThÃ´ng bÃ¡o: "ÄÆ¡n Ä‘Ã£ chuáº©n bá»‹, khÃ´ng thá»ƒ hoÃ n tiá»n"
      A2.10. [Optional] HoÃ n 50% theo chÃ­nh sÃ¡ch
```

**A3: KhÃ¡ch Ä‘áº¿n muá»™n, order Ä‘Ã£ láº¡nh**

```
A3.1. Thu ngÃ¢n kiá»ƒm tra order time
A3.2. IF quÃ¡ lÃ¢u (> 30 phÃºt):
      A3.3. Xin lá»—i khÃ¡ch
      A3.4. Há»i: "Anh/chá»‹ cÃ³ muá»‘n lÃ m láº¡i khÃ´ng?"
      A3.5. [If yes] Gá»­i order má»›i Ä‘áº¿n báº¿p (Æ°u tiÃªn)
      A3.6. [If no] BÃ n giao hÃ ng, giáº£m giÃ¡ 10-20%
```

**Postconditions:**

- Order Ä‘Æ°á»£c táº¡o vÃ  xá»­ lÃ½
- KhÃ¡ch nháº­n hÃ ng thÃ nh cÃ´ng
- [If paid] Thanh toÃ¡n hoÃ n táº¥t
- [If member] Äiá»ƒm Ä‘Æ°á»£c cá»™ng

---

### Use Case 7: Xá»­ lÃ½ Order tá»« Delivery (Giao hÃ ng)

**Actors:** Äiá»‡n thoáº¡i viÃªn/Online system, KhÃ¡ch hÃ ng, Báº¿p, Shipper

**Preconditions:**

- Há»‡ thá»‘ng delivery Ä‘ang hoáº¡t Ä‘á»™ng
- CÃ³ shipper available

**Main Flow:**

```
1. KhÃ¡ch Ä‘áº·t hÃ ng qua:
   - Äiá»‡n thoáº¡i
   - App/Website
   - Facebook/Zalo

2. Tiáº¿p nháº­n order:

   CASE Äiá»‡n thoáº¡i:
   2.1. NhÃ¢n viÃªn nháº­n cuá»™c gá»i
   2.2. Ghi nháº­n thÃ´ng tin:
       - Há» tÃªn
       - Sá»‘ Ä‘iá»‡n thoáº¡i
       - Äá»‹a chá»‰ giao hÃ ng chi tiáº¿t
       - Order items
   2.3. XÃ¡c nháº­n láº¡i vá»›i khÃ¡ch
   2.4. Nháº­p vÃ o há»‡ thá»‘ng

   CASE Online:
   2.5. Order tá»± Ä‘á»™ng vÃ o há»‡ thá»‘ng
   2.6. NhÃ¢n viÃªn nháº­n notification

3. Kiá»ƒm tra kháº£ nÄƒng giao:
   3.1. Kiá»ƒm tra khoáº£ng cÃ¡ch (< 5km)
   3.2. Kiá»ƒm tra giÃ¡ trá»‹ Ä‘Æ¡n tá»‘i thiá»ƒu
   3.3. Kiá»ƒm tra tá»“n kho
   3.4. Kiá»ƒm tra shipper available

4. [If OK] XÃ¡c nháº­n vá»›i khÃ¡ch:
   4.1. TÃ­nh phÃ­ ship:
       - 0-2km: 15,000Ä‘
       - 2-5km: 25,000Ä‘
       - 5-10km: 35,000Ä‘
   4.2. TÃ­nh tá»•ng: Subtotal + Ship fee
   4.3. Estimate delivery time:
       Prep time + Travel time
       = 30 phÃºt + (distance Ã— 10 phÃºt/km)
   4.4. Gá»i láº¡i khÃ¡ch xÃ¡c nháº­n:
       "Tá»•ng XXXÄ‘, giao trong khoáº£ng 45 phÃºt, anh/chá»‹ Ä‘á»“ng Ã½ khÃ´ng?"

5. [If confirmed] Táº¡o order:
   5.1. Type: DELIVERY
   5.2. Status: CONFIRMED
   5.3. deliveryInfo:
       - address
       - phone
       - coordinates
       - deliveryFee
       - estimatedTime
   5.4. Payment method:
       - COD (Ship COD)
       - Pre-paid (Online payment)

6. Gá»­i order Ä‘áº¿n báº¿p vá»›i priority: DELIVERY

7. Assign shipper:
   7.1. Há»‡ thá»‘ng chá»n shipper:
       - Äang ráº£nh
       - Gáº§n nháº¥t
       - Rating cao
   7.2. Gá»­i notification Ä‘áº¿n shipper:
       "Order #XXX - Äá»‹a chá»‰: [address] - COD: XXXÄ‘"
   7.3. Shipper accept/reject
   7.4. [If reject] Assign shipper khÃ¡c

8. Theo dÃµi order status:

   8.1. CONFIRMED â†’ PREPARING (Báº¿p báº¯t Ä‘áº§u)
   8.2. PREPARING â†’ READY (MÃ³n xong)
   8.3. Notification shipper: "Order ready for pickup"
   8.4. READY â†’ OUT_FOR_DELIVERY (Shipper láº¥y hÃ ng)
   8.5. OUT_FOR_DELIVERY â†’ DELIVERED (Giao thÃ nh cÃ´ng)

9. Shipper giao hÃ ng:
   9.1. Äáº¿n Ä‘á»‹a chá»‰ khÃ¡ch
   9.2. Gá»i Ä‘iá»‡n thÃ´ng bÃ¡o
   9.3. BÃ n giao hÃ ng
   9.4. [If COD] Thu tiá»n
   9.5. Update status: DELIVERED
   9.6. [Optional] KhÃ¡ch kÃ½ nháº­n/chá»¥p áº£nh

10. HoÃ n táº¥t:
    10.1. Cáº­p nháº­t status: COMPLETED
    10.2. [If COD] Shipper ná»™p tiá»n vá» quáº§y
    10.3. [If member] Cá»™ng Ä‘iá»ƒm
    10.4. Ghi nháº­n doanh thu

11. [Optional] Gá»­i SMS cáº£m Æ¡n + feedback link
```

**Alternative Flows:**

**A1: NgoÃ i khu vá»±c giao hÃ ng (táº¡i bÆ°á»›c 3.1)**

```
A1.1. Há»‡ thá»‘ng hiá»ƒn thá»‹ "NgoÃ i pháº¡m vi giao hÃ ng"
A1.2. NhÃ¢n viÃªn thÃ´ng bÃ¡o khÃ¡ch:
      "Xin lá»—i, hiá»‡n chÃºng tÃ´i chá»‰ giao trong bÃ¡n kÃ­nh 5km"
A1.3. [Optional] Äá» xuáº¥t:
      - KhÃ¡ch tá»± Ä‘áº¿n láº¥y (Takeaway)
      - Sá»­ dá»¥ng dá»‹ch vá»¥ ship khÃ¡c
```

**A2: KhÃ´ng cÃ³ shipper (táº¡i bÆ°á»›c 7.1)**

```
A2.1. Há»‡ thá»‘ng thÃ´ng bÃ¡o "No shipper available"
A2.2. NhÃ¢n viÃªn gá»i khÃ¡ch:
      "Hiá»‡n shipper Ä‘ang báº­n, cÃ³ thá»ƒ giao muá»™n 20-30 phÃºt, anh/chá»‹ cÃ³ Ä‘á»“ng Ã½ khÃ´ng?"
A2.3. [If yes] Giá»¯ order, chá» shipper ráº£nh
A2.4. [If no] Há»§y order, xin lá»—i khÃ¡ch
```

**A3: KhÃ¡ch khÃ´ng nháº­n mÃ¡y/khÃ´ng cÃ³ nhÃ  (táº¡i bÆ°á»›c 9.2)**

```
A3.1. Shipper gá»i 3 láº§n khÃ´ng Ä‘Æ°á»£c
A3.2. BÃ¡o láº¡i nhÃ¢n viÃªn
A3.3. NhÃ¢n viÃªn gá»i sá»‘ dá»± phÃ²ng (náº¿u cÃ³)
A3.4. [If still khÃ´ng liÃªn láº¡c Ä‘Æ°á»£c]:
      A3.5. Chá» 10 phÃºt
      A3.6. Gá»i láº¡i 1 láº§n
A3.7. [If váº«n khÃ´ng Ä‘Æ°á»£c]:
      A3.8. Shipper mang hÃ ng vá»
      A3.9. Order status: FAILED_DELIVERY
      A3.10. Gá»i khÃ¡ch xÃ¡c nháº­n cÃ³ muá»‘n ship láº¡i khÃ´ng
```

**A4: KhÃ¡ch phÃ n nÃ n vá» mÃ³n Äƒn (sau khi giao)**

```
A4.1. KhÃ¡ch gá»i Ä‘iá»‡n pháº£n Ã¡nh:
       - MÃ³n sai
       - MÃ³n thiáº¿u
       - Cháº¥t lÆ°á»£ng khÃ´ng tá»‘t
A4.2. NhÃ¢n viÃªn ghi nháº­n chi tiáº¿t
A4.3. Xin lá»—i khÃ¡ch
A4.4. ÄÆ°a giáº£i phÃ¡p:

      IF mÃ³n sai/thiáº¿u:
      A4.5. Ship láº¡i mÃ³n Ä‘Ãºng ngay (miá»…n phÃ­)

      IF cháº¥t lÆ°á»£ng kÃ©m:
      A4.6. HoÃ n tiá»n 100%
      A4.7. Hoáº·c lÃ m láº¡i mÃ³n vÃ  ship láº¡i
      A4.8. Táº·ng voucher xin lá»—i

A4.9. Ghi nháº­n incident, Ä‘iá»u tra nguyÃªn nhÃ¢n
A4.10. Cáº£i thiá»‡n quy trÃ¬nh
```

**Postconditions:**

- Order Ä‘Æ°á»£c giao thÃ nh cÃ´ng
- KhÃ¡ch nháº­n hÃ ng vÃ  thanh toÃ¡n
- Shipper hoÃ n thÃ nh nhiá»‡m vá»¥
- Doanh thu Ä‘Æ°á»£c ghi nháº­n
- [If member] Äiá»ƒm Ä‘Æ°á»£c cá»™ng

---

## Business Rules

### Thanh ToÃ¡n

- Chá»‰ thanh toÃ¡n Ä‘Æ¡n cÃ³ status = PENDING hoáº·c READY
- Sá»‘ tiá»n thanh toÃ¡n pháº£i báº±ng tá»•ng tiá»n
- Cáº­p nháº­t tá»“n kho sau khi thanh toÃ¡n thÃ nh cÃ´ng
- Táº¡o hÃ³a Ä‘Æ¡n tá»± Ä‘á»™ng

### Há»§y ÄÆ¡n

- Chá»‰ há»§y Ä‘Æ¡n chÆ°a chuáº©n bá»‹ (status = PENDING)
- HoÃ n láº¡i tá»“n kho náº¿u Ä‘Ã£ trá»«
- Ghi rÃµ lÃ½ do há»§y
- HoÃ n tiá»n náº¿u Ä‘Ã£ thanh toÃ¡n

---

**Last Updated:** November 23, 2025  
**Version:** 1.0.0  
**Status:** Planned
